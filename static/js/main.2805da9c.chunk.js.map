{"version":3,"sources":["notesReducer.js","localStorageReducer.js","LoginModal.js","LoginUpSellBanner.js","LoginStatusBanner.js","firebaseConnector.js","LoginBarWithBanners.js","AddCard.js","ConfirmModal.js","NoteCard.js","NotesContainer.js","remoteDispatch.js","App.js","serviceWorker.js","index.js"],"names":["replaceNote","notes","id","content","index","findIndex","note","slice","concat","Object","objectSpread","removeNote","reducer","state","action","console","log","type","loginEmail","data","loginFlowStage","upSellDisabled","connectState","undefined","dataReducer","Error","LOCAL_STORAGE_KEY","initState","loadedDataState","storedItem","localStorage","getItem","JSON","parse","e","localStorageReducer","_notesReducer","useReducer","_notesReducer2","slicedToArray","dispatch","useEffect","dataState","setItem","stringify","LoginModal","_ref","show","initialEmail","onCancel","onConfirm","_useState","useState","_useState2","email","setEmail","react_default","a","createElement","Modal","onHide","Form","onSubmit","event","preventDefault","Header","closeButton","Title","Body","style","paddingBottom","Group","controlId","Label","Control","placeholder","onChange","target","value","Text","className","Footer","Button","variant","onClick","LoginUpsellBanner","onDismiss","onAction","Alert_default","dismissible","onClose","Heading","href","LoginStatusBanner","db","user","status","onLogin","showingWarning","setShowingWarning","_useState3","_useState4","showingError","setShowingError","firebase","require","actionCodeSettings","url","handleCodeInApp","setConnectState","init","apps","length","initializeApp","config","firestore","enablePersistence","catch","err","error","code","_callee","regenerator_default","wrap","_context","prev","next","abrupt","addUserStateListener","sent","t0","stop","_callee2","_context2","Promise","resolve","reject","auth","onAuthStateChanged","userObject","_callee3","_context3","sendSignInLinkToEmail","_callee4","address","_context4","isSignInWithEmailLink","signInWithEmailLink","_callee5","_context5","signOut","_callee6","_context6","retrieveNotes","sendNotes","_callee7","localNotes","_context7","collection","where","uid","get","forEach","doc","remoteData","find","updateNoteLocally","storeNoteLocally","_callee8","_context8","all","map","startsWith","storeNoteRemotely","source","title","body","_callee9","docRef","_context9","add","owner","_callee10","_context10","set","_callee11","_context11","delete","firebaseConnector","waitForUserAuth","startLogin","finishLogin","logout","sync","listenToChanges","onSnapshot","includeMetadataChanges","snapshot","metadata","fromCache","hasPendingWrites","docChanges","change","removeNoteLocally","updateNoteRemotely","removeNoteRemotely","LoginBarWithBanners","_useContext","useContext","StateContext","_useContext2","loginDialogVisible","setLoginDialogVisible","asyncToGenerator","mark","connector","_x","apply","this","arguments","Fragment","src_LoginModal","Navbar","bg","fixed","expand","onSelect","key","Brand","Toggle","aria-controls","Collapse","Nav","Link","LoginUpSellBanner","src_LoginStatusBanner","AddCard","Card_default","width","height","margin","marginBottom","borderStyle","background","borderColor","borderWidth","color","verticalAlign","ConfirmModal","message","Modal_default","Button_default","NoteCard","update","remove","editing","setEditing","setTitle","_useState5","_useState6","setBody","_useState7","_useState8","dialogVisible","setDialogVisible","src_ConfirmModal","Form_default","noValidate","as","defaultValue","display","justifyContent","overflow","whiteSpace","NotesContainer","Container","Row","item","Col","xs","sm","md","lg","xl","src_NoteCard","src_AddCard","Date","getTime","createRemoteDispatch","handleAction","createContext","match","history","window","location","push","App","_localStorageReducer","_localStorageReducer2","localDispatch","isLoggedIn","react_router_dom","react_router","path","render","_ref2","handleLogin","_ref3","params","section","Provider","src_LoginBarWithBanners","src_NotesContainer","Boolean","hostname","ReactDOM","src_App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"2kBAoCA,SAASA,EAAYC,EAAoBC,EAAYC,GACjD,IAAMC,EAAQH,EAAMI,UAAU,SAAAC,GAAI,OAAIA,EAAKJ,KAAOA,IAClD,OAAe,IAAXE,EAAqBH,EAClBA,EACFM,MAAM,EAAGH,GACTI,OAFEC,OAAAC,EAAA,EAAAD,CAAA,GAGIN,EAHJ,CAICD,GAAIC,EAAQD,IAAMA,KAErBM,OACGP,EAAMM,MAAMH,EAAQ,IAIhC,SAASO,EAAWV,EAAoBC,GACpC,IAAME,EAAQH,EAAMI,UAAU,SAAAC,GAAI,OAAIA,EAAKJ,KAAOA,IAClD,OAAe,IAAXE,EAAqBH,EAClBA,EACFM,MAAM,EAAGH,GACTI,OACGP,EAAMM,MAAMH,EAAQ,IAOzB,SAASQ,EAAQC,EAAcC,GAElC,OADAC,QAAQC,IAAI,kBAAmBF,EAAOG,KAAMH,GACpCA,EAAOG,MACX,IAAK,aACD,OAAyB,MAArBH,EAAOI,WAA2BL,EAC/BJ,OAAAC,EAAA,EAAAD,CAAA,GACAI,EADP,CAEIM,KAAKV,OAAAC,EAAA,EAAAD,CAAA,GACEI,EAAMM,KADT,CAEAD,WAAYJ,EAAOI,WACnBE,eAAgB,UAChBC,gBAAgB,IAEpBC,aAAc,iBAEtB,IAAK,gBACD,OAAOb,OAAAC,EAAA,EAAAD,CAAA,GACAI,EADP,CAEIM,KAAKV,OAAAC,EAAA,EAAAD,CAAA,GACEI,EAAMM,KADT,CAEAC,eAAgB,cAEpBE,aAAc,aAEtB,IAAK,cACD,OAAOb,OAAAC,EAAA,EAAAD,CAAA,GACAI,EADP,CAEIM,KAAKV,OAAAC,EAAA,EAAAD,CAAA,GACEI,EAAMM,MAEbG,aAAc,gBAEtB,IAAK,SACD,OAAOb,OAAAC,EAAA,EAAAD,CAAA,GACAI,EADP,CAEIM,KAAKV,OAAAC,EAAA,EAAAD,CAAA,GACEI,EAAMM,KADT,CAEAD,gBAAYK,EACZH,oBAAgBG,IAEpBD,kBAAcC,IAEtB,IAAK,kBACD,OAAOd,OAAAC,EAAA,EAAAD,CAAA,GACAI,EADP,CAEIS,aAAcR,EAAOQ,eAE7B,QAAS,OAAOb,OAAAC,EAAA,EAAAD,CAAA,GACTI,EADE,CAELM,KAAMK,EAAYX,EAAMM,KAAML,MAQ1C,SAASU,EAAYX,EAAkBC,GACnC,OAAQA,EAAOG,MACX,IAAK,UACD,OAAOR,OAAAC,EAAA,EAAAD,CAAA,GACAI,EADP,CAEIZ,OApGCA,EAoGcY,EAAMZ,MApGAE,EAoGOW,EAAOX,SAlGhC,IADDF,EAAMI,UAAU,SAAAC,GAAI,OAAIA,EAAKJ,KAAOC,EAAQD,KACjCD,GAEzBc,QAAQC,IAAI,wBAAyBb,EAAQD,IACtCD,EACFO,OADEC,OAAAC,EAAA,EAAAD,CAAA,GAEIN,QA+FP,IAAK,aACD,OAAiB,MAAbW,EAAOZ,GAAmBW,EACvBJ,OAAAC,EAAA,EAAAD,CAAA,GACAI,EADP,CAEIZ,MAAOD,EAAYa,EAAMZ,MAAOa,EAAOZ,GAAIY,EAAOX,WAE1D,IAAK,aACD,OAAiB,MAAbW,EAAOZ,GAAmBW,EACvBJ,OAAAC,EAAA,EAAAD,CAAA,GACAI,EADP,CAEIZ,MAAOU,EAAWE,EAAMZ,MAAOa,EAAOZ,MAE9C,IAAK,gBACD,OAAOO,OAAAC,EAAA,EAAAD,CAAA,GACAI,EADP,CAEIQ,gBAAgB,IAGxB,QAAS,MAAM,IAAII,MAAM,mBAAqBX,EAAOG,MAxH7D,IAAiBhB,EAAoBE,ECfrC,IAAMuB,EAAoB,WAE1B,SAASC,IACLZ,QAAQC,IAAI,mCACZ,IACIY,EADEC,EAAaC,aAAaC,QAAQL,IAAsB,GAE9D,IACIE,EAAkBI,KAAKC,MAAMJ,GAC/B,MAAOK,GACLN,EAAkB,KAEtB,MAAO,CACHT,KAAMS,GAAmB,CACrB3B,MAAO,KAoBJkC,MAVf,WAA+B,IDoHMR,ECpHNS,GDoHMT,ECnHMA,EDoHhCU,qBAA6BzB,EAAS,KAAMe,ICrHxBW,EAAA7B,OAAA8B,EAAA,EAAA9B,CAAA2B,EAAA,GACpBvB,EADoByB,EAAA,GACbE,EADaF,EAAA,GAO3B,OAJAG,oBAAU,WARd,IAAmBC,IASD7B,EAAMM,KARpBJ,QAAQC,IAAI,gCACZc,aAAaa,QAAQjB,EAAmBM,KAAKY,UAAUF,KAQpD,CAAC7B,EAAMM,OAEH,CAACN,EAAO2B,iDCgBJK,MAzCf,SAAAC,GAA4E,IAAvDC,EAAuDD,EAAvDC,KAAMC,EAAiDF,EAAjDE,aAAcC,EAAmCH,EAAnCG,SAAUC,EAAyBJ,EAAzBI,UAAyBC,EAC9CC,mBAASJ,GADqCK,EAAA5C,OAAA8B,EAAA,EAAA9B,CAAA0C,EAAA,GACjEG,EADiED,EAAA,GAC1DE,EAD0DF,EAAA,GAQxE,OACEG,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAOZ,KAAMA,EAAMa,OAAQX,GACzBO,EAAAC,EAAAC,cAACG,EAAA,EAAD,CAAMC,SAPO,SAACC,GAChBA,EAAMC,iBACFV,GAAOJ,EAAUI,KAMjBE,EAAAC,EAAAC,cAACC,EAAA,EAAMM,OAAP,CAAcC,aAAW,GACvBV,EAAAC,EAAAC,cAACC,EAAA,EAAMQ,MAAP,0BAEFX,EAAAC,EAAAC,cAACC,EAAA,EAAMS,KAAP,KACEZ,EAAAC,EAAAC,cAAA,OAAKW,MAAO,CAACC,cAAe,KAA5B,qGACEd,EAAAC,EAAAC,cAACG,EAAA,EAAKU,MAAN,CAAYC,UAAU,kBACpBhB,EAAAC,EAAAC,cAACG,EAAA,EAAKY,MAAN,sBACAjB,EAAAC,EAAAC,cAACG,EAAA,EAAKa,QAAN,CACEzD,KAAK,QACL0D,YAAY,cACZC,SAAU,SAAC1C,GAAD,OAAOqB,EAASrB,EAAE2C,OAAOC,UAErCtB,EAAAC,EAAAC,cAACG,EAAA,EAAKkB,KAAN,CAAWC,UAAU,cAArB,oDAKNxB,EAAAC,EAAAC,cAACC,EAAA,EAAMsB,OAAP,KACEzB,EAAAC,EAAAC,cAACwB,EAAA,EAAD,CAAQC,QAAQ,YAAYC,QAASnC,GAArC,UAGAO,EAAAC,EAAAC,cAACwB,EAAA,EAAD,CAAQC,QAAQ,UAAUlE,KAAK,UAA/B,8BCbGoE,MApBf,SAAAvC,GAA+D,IAAnCwC,EAAmCxC,EAAnCwC,UAAWC,EAAwBzC,EAAxByC,SAMnC,OACI/B,EAAAC,EAAAC,cAAC8B,EAAA/B,EAAD,CACIgC,aAAW,EACXN,QAAQ,UACRO,QAASJ,GACT9B,EAAAC,EAAAC,cAAC8B,EAAA/B,EAAMkC,QAAP,+BACAnC,EAAAC,EAAAC,cAAA,yDAEIF,EAAAC,EAAAC,cAAA,KAAGkC,KAAK,SAASR,QAbb,SAACrB,GACbA,EAAMC,iBACNuB,MAWQ,cAFJ,OC2CGM,IC1DXC,EACAC,EDyDWF,EAtDf,SAAA/C,GAA2D,IAA/BkD,EAA+BlD,EAA/BkD,OAAQC,EAAuBnD,EAAvBmD,QAAuB9C,EACXC,oBAAS,GADEC,EAAA5C,OAAA8B,EAAA,EAAA9B,CAAA0C,EAAA,GAChD+C,EADgD7C,EAAA,GAChC8C,EADgC9C,EAAA,GAAA+C,EAEfhD,oBAAS,GAFMiD,EAAA5F,OAAA8B,EAAA,EAAA9B,CAAA2F,EAAA,GAEhDE,EAFgDD,EAAA,GAElCE,EAFkCF,EAAA,GAQvD,OAAQL,GACJ,IAAK,eACD,OACIxC,EAAAC,EAAAC,cAAC8B,EAAA/B,EAAD,CACIgC,aAAW,EACXN,QAAQ,UACRpC,KAAMmD,EACNR,QAAS,kBAAMS,GAAkB,KAEjC3C,EAAAC,EAAAC,cAAC8B,EAAA/B,EAAMkC,QAAP,yBACAnC,EAAAC,EAAAC,cAAA,+DAKZ,IAAK,WACD,OACIF,EAAAC,EAAAC,cAAC8B,EAAA/B,EAAD,CACIgC,aAAW,EACXN,QAAQ,UACRpC,KAAMmD,EACNR,QAAS,kBAAMS,GAAkB,KAEjC3C,EAAAC,EAAAC,cAAC8B,EAAA/B,EAAMkC,QAAP,mBAGZ,IAAK,cACD,OACInC,EAAAC,EAAAC,cAAC8B,EAAA/B,EAAD,CACIgC,aAAW,EACXN,QAAQ,SACRpC,KAAMuD,EACNZ,QAAS,kBAAMa,GAAgB,KAE/B/C,EAAAC,EAAAC,cAAC8B,EAAA/B,EAAMkC,QAAP,qBACAnC,EAAAC,EAAAC,cAAA,sBAEIF,EAAAC,EAAAC,cAAA,KAAGkC,KAAK,SAASR,QA1CrB,SAACrB,GACbA,EAAMC,iBACNiC,MAwCgB,SAFJ,eAMZ,QACI,OAAO,gBC1DbO,EAAWC,EAAQ,KACzBA,EAAQ,KACRA,EAAQ,KAIR,IACMC,EAAqB,CACvBC,IAAG,GAAAnG,OAFiD,yCAEjD,iBACHoG,iBAAiB,GAGrB,SAASC,EAAgBvF,EAA4BkB,GACjDA,EAAS,CACLvB,KAAM,kBACNK,iBAIR,SAASwF,EAAKjG,EAAc2B,GACxB,IACSgE,EAASO,KAAKC,SACfjG,QAAQC,IAAI,yBACZwF,EAASS,cAAcC,IAU/BpB,EAAKU,EAASW,aACXC,oBACEC,MAAM,SAASC,GACZvG,QAAQwG,MAAM,mDAAoDD,GAAOA,EAAIE,SAVnF,MAAOF,GACLvG,QAAQwG,MAAM,iCAAkCD,GAAOA,EAAIE,MAC3DX,EAAgB,cAAerE,+CAYvC,SAAAiF,EAA+B5G,EAAc2B,GAA7C,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,WACQ/B,EADR,CAAA6B,EAAAE,KAAA,eAAAF,EAAAG,OAAA,SACqBhC,GADrB,cAAA6B,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAGqBE,EAAqBnH,EAAO2B,GAHjD,cAAAoF,EAAAG,OAAA,SAAAH,EAAAK,MAAA,cAAAL,EAAAC,KAAA,EAAAD,EAAAM,GAAAN,EAAA,SAKQ7G,QAAQwG,MAAM,iCAAkCK,EAAAM,IAAON,EAAAM,GAAIV,MAC3DX,EAAgB,cAAerE,GANvCoF,EAAAG,OAAA,SAOe,MAPf,yBAAAH,EAAAO,SAAAV,EAAA,iDAWeO,iFAAf,SAAAI,EAAoCvH,EAAc2B,GAAlD,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAAU,GAAA,cAAAA,EAAAR,KAAAQ,EAAAP,MAAA,cAAAO,EAAAN,OAAA,SACW,IAAIO,QAAQ,SAACC,EAASC,GACzBhC,EAASiC,OAAOC,mBAAmB,SAACC,GAChC5H,QAAQC,IAAI,0BAA2B2H,GACnCA,GACA5C,EAAO4C,EACPnG,EAAS,CAACvB,KAAM,kBAChBsH,EAAQxC,KAERA,EAAO,KACPc,EAAgB,cAAerE,GAC/B+F,EAAQ,YAXxB,wBAAAF,EAAAF,SAAAC,wEAiBA,SAAAQ,EAA0BtF,EAAezC,EAAc2B,GAAvD,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAAkB,GAAA,cAAAA,EAAAhB,KAAAgB,EAAAf,MAAA,cAAAe,EAAAhB,KAAA,EAEQ9G,QAAQC,IAAI,kBACZ8F,EAAKjG,EAAO2B,GAHpBqG,EAAAf,KAAA,EAIctB,EAASiC,OAAOK,sBAAsBxF,EAAOoD,GAJ3D,OAKQlE,EAAS,CACLvB,KAAM,aACNC,WAAYoC,IAPxBuF,EAAAf,KAAA,gBAAAe,EAAAhB,KAAA,EAAAgB,EAAAX,GAAAW,EAAA,SAUQ9H,QAAQwG,MAAM,2BAA4BsB,EAAAX,IAAOW,EAAAX,GAAIV,MACrDX,EAAgB,cAAerE,GAXvC,yBAAAqG,EAAAV,SAAAS,EAAA,mFAeA,SAAAG,EAA2BC,EAAiB1F,EAAezC,EAAc2B,GAAzE,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAAsB,GAAA,cAAAA,EAAApB,KAAAoB,EAAAnB,MAAA,UAAAmB,EAAApB,KAAA,EAEarB,EAASiC,OAAOS,sBAAsBF,GAFnD,CAAAC,EAAAnB,KAAA,eAGY/G,QAAQwG,MAAM,wCAAyCyB,GACvDxG,EAAS,CAACvB,KAAM,gBAJ5BgI,EAAAlB,OAAA,wBAAAkB,EAAAnB,KAAA,EAOctB,EAASiC,OAAOU,oBAAoB7F,EAAO0F,GAPzD,OAQQxG,EAAS,CAACvB,KAAM,kBARxBgI,EAAAnB,KAAA,iBAAAmB,EAAApB,KAAA,GAAAoB,EAAAf,GAAAe,EAAA,SAUQlI,QAAQwG,MAAM,0BAAd0B,EAAAf,GAAgDe,EAAAf,IAASe,EAAAf,GAAMV,MAC/DhF,EAAS,CAACvB,KAAM,gBAXxB,yBAAAgI,EAAAd,SAAAY,EAAA,oFAeA,SAAAK,EAAsBvI,EAAc2B,GAApC,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAA0B,GAAA,cAAAA,EAAAxB,KAAAwB,EAAAvB,MAAA,cAAAuB,EAAAvB,KAAA,EACUtB,EAASiC,OAAOa,UAD1B,OAEI9G,EAAS,CACLvB,KAAM,WAHd,wBAAAoI,EAAAlB,SAAAiB,wEAOA,SAAAG,EAAoB1I,EAAc2B,GAAlC,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAA6B,GAAA,cAAAA,EAAA3B,KAAA2B,EAAA1B,MAAA,UACShC,GAAOC,EADhB,CAAAyD,EAAA1B,KAAA,cAEQ/G,QAAQwG,MAAM,8BACR,IAAI9F,MAAM,8BAHxB,cAAA+H,EAAA1B,KAAA,EAMU2B,EAAc5I,EAAMM,KAAKlB,MAAOuC,GAN1C,cAAAgH,EAAAzB,OAAA,SAOW2B,EAAU7I,EAAMM,KAAKlB,MAAOuC,IAPvC,wBAAAgH,EAAArB,SAAAoB,sCAsCeE,iFAAf,SAAAE,EAA6BC,EAAyBpH,GAAtD,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAAkC,GAAA,cAAAA,EAAAhC,KAAAgC,EAAA/B,MAAA,UACS/B,EADT,CAAA8D,EAAA/B,KAAA,cACqB,IAAIrG,MAAM,iBAD/B,cAAAoI,EAAA/B,KAAA,EAEgChC,EAAGgE,WAAW,SAASC,MAAM,QAAS,KAAMhE,EAAKiE,KAAKC,MAFtF,OAAAJ,EAAA5B,KAGkBiC,QAAQ,SAACC,GACnB,IAAMC,EAAaD,EAAIhJ,OACvBJ,QAAQC,IAAR,GAAAR,OAAe2J,EAAIjK,GAAnB,OAA4BkK,GACVR,EAAWS,KAAK,SAAC/J,GAAD,OAAUA,EAAKJ,KAAOiK,EAAIjK,KAGxDoK,EAAkBH,EAAIjK,GAAIkK,EAAY5H,GAEtC+H,EAAiBJ,EAAIjK,GAAIkK,EAAY5H,KAXjD,wBAAAqH,EAAA1B,SAAAwB,sCAgBeD,iFAAf,SAAAc,EAAyBvK,EAAoBuC,GAA7C,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAA8C,GAAA,cAAAA,EAAA5C,KAAA4C,EAAA3C,MAAA,cACI/G,QAAQC,IAAI,iCADhByJ,EAAA3C,KAAA,EAEUQ,QAAQoC,IACVzK,EAAM0K,IAAI,SAACrK,GACP,OAAIA,EAAKJ,GAAG0K,WAAW,UAEZC,EAAkBvK,EAAMkC,GACrB,IAAI8F,QAAQ,SAACC,EAASC,GAAV,OAAqBD,SAP3D,wBAAAkC,EAAAtC,SAAAqC,6BAYA,SAASF,EAAkBpK,EAAIiB,EAAMqB,GACjCA,EAAS,CACLvB,KAAM,aACN6J,OAAQ,SACR5K,GAAIA,EACJC,QAAS,CACL4K,MAAO5J,EAAK4J,MACZC,KAAM7J,EAAK6J,QAKvB,SAAST,EAAiBrK,EAAIiB,EAAMqB,GAChCA,EAAS,CACLvB,KAAM,UACN6J,OAAQ,SACR3K,QAAS,CACLD,GAAIA,EACJ6K,MAAO5J,EAAK4J,MACZC,KAAM7J,EAAK6J,iBAaRH,iFAAf,SAAAI,EAAiC3K,EAAYkC,GAA7C,IAAA0I,EAAA,OAAAxD,EAAAjE,EAAAkE,KAAA,SAAAwD,GAAA,cAAAA,EAAAtD,KAAAsD,EAAArD,MAAA,UACI/G,QAAQC,IAAI,0BACP+E,EAFT,CAAAoF,EAAArD,KAAA,cAEqB,IAAIrG,MAAM,iBAF/B,cAAA0J,EAAAtD,KAAA,EAAAsD,EAAArD,KAAA,EAK6BhC,EAAGgE,WAAW,SAASsB,IAAI,CAC5CL,MAAOzK,EAAKyK,MACZC,KAAM1K,EAAK0K,KACXK,MAAOtF,EAAKiE,MARxB,OAKckB,EALdC,EAAAlD,KAUQlH,QAAQC,IAAI,6BAA8BkK,EAAOhL,IAEjDsC,EAAS,CACLvB,KAAM,aACN6J,OAAQ,SACR5K,GAAII,EAAKJ,GACTC,QAAS,CACLD,GAAIgL,EAAOhL,GACX6K,MAAOzK,EAAKyK,MACZC,KAAM1K,EAAK0K,QAnB3BG,EAAArD,KAAA,iBAAAqD,EAAAtD,KAAA,GAAAsD,EAAAjD,GAAAiD,EAAA,SAuBQpK,QAAQwG,MAAM,0BAAd4D,EAAAjD,IAvBR,yBAAAiD,EAAAhD,SAAA8C,EAAA,oFA2BA,SAAAK,EAAkChL,EAAYkC,GAA9C,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAA4D,GAAA,cAAAA,EAAA1D,KAAA0D,EAAAzD,MAAA,UACI/G,QAAQC,IAAI,2BACP+E,EAFT,CAAAwF,EAAAzD,KAAA,cAEqB,IAAIrG,MAAM,iBAF/B,cAAA8J,EAAA1D,KAAA,EAAA0D,EAAAzD,KAAA,EAKchC,EAAGgE,WAAW,SAASK,IAAI7J,EAAKJ,IAAIsL,IAAI,CAC1CT,MAAOzK,EAAKyK,MACZC,KAAM1K,EAAK0K,KACXK,MAAOtF,EAAKiE,MARxB,OAUQjJ,QAAQC,IAAR,YAAAR,OAAwBF,EAAKJ,GAA7B,aAVRqL,EAAAzD,KAAA,gBAAAyD,EAAA1D,KAAA,EAAA0D,EAAArD,GAAAqD,EAAA,SAYQxK,QAAQwG,MAAR,2BAAA/G,OAAyCF,EAAKJ,GAA9C,MAAAqL,EAAArD,IAZR,yBAAAqD,EAAApD,SAAAmD,EAAA,qFAgBA,SAAAG,EAAkCvL,EAAYsC,GAA9C,OAAAkF,EAAAjE,EAAAkE,KAAA,SAAA+D,GAAA,cAAAA,EAAA7D,KAAA6D,EAAA5D,MAAA,UACI/G,QAAQC,IAAI,6BACP+E,EAFT,CAAA2F,EAAA5D,KAAA,cAEqB,IAAIrG,MAAM,iBAF/B,cAAAiK,EAAA7D,KAAA,EAAA6D,EAAA5D,KAAA,EAKchC,EAAGgE,WAAW,SAASK,IAAIjK,GAAIyL,SAL7C,OAMQ5K,QAAQC,IAAR,mBAAAR,OAA+BN,EAA/B,aANRwL,EAAA5D,KAAA,gBAAA4D,EAAA7D,KAAA,EAAA6D,EAAAxD,GAAAwD,EAAA,SAQQ3K,QAAQwG,MAAR,2BAAA/G,OAAyCN,EAAzC,MAAAwL,EAAAxD,IARR,yBAAAwD,EAAAvD,SAAAsD,EAAA,wCAYe,IAAAG,GAAA,CACX9E,OACA+E,8DACAC,2DACAC,8DACAC,qDACAC,mDACAC,gBAtJJ,SAAyBrL,EAAc2B,GAC9BsD,GAAOC,EAKZD,EAAGgE,WAAW,SAASC,MAAM,QAAS,KAAMhE,EAAKiE,KAC5CmC,WAAW,CAACC,wBAAwB,GAAO,SAACC,GAEpCA,EAASC,SAASC,WAAcF,EAASC,SAASE,kBACnDH,EAASI,aAAavC,QAAQ,SAASwC,GAEf,UAAhBA,EAAOzL,KAEPsJ,EAAiBmC,EAAOvC,IAAIjK,GAAIwM,EAAOvC,IAAIhJ,OAAQqB,GAC5B,aAAhBkK,EAAOzL,KAEdqJ,EAAkBoC,EAAOvC,IAAIjK,GAAIwM,EAAOvC,IAAIhJ,OAAQqB,GAC7B,YAAhBkK,EAAOzL,MA8DtC,SAA2Bf,EAAIsC,GAC3BA,EAAS,CACLvB,KAAM,aACN6J,OAAQ,SACR5K,GAAIA,IAhEYyM,CAAkBD,EAAOvC,IAAIjK,GAAIsC,OAlBjDzB,QAAQwG,MAAM,8DAqJlBsD,oBACA+B,iEACAC,mEChMWC,OAtEf,WAAqC,IAAAC,EACPC,qBAAWC,IADJC,EAAAzM,OAAA8B,EAAA,EAAA9B,CAAAsM,EAAA,GAC1BlM,EAD0BqM,EAAA,GACnB1K,EADmB0K,EAAA,GAAA/J,EAEmBC,oBAAS,GAF5BC,EAAA5C,OAAA8B,EAAA,EAAA9B,CAAA0C,EAAA,GAE1BgK,EAF0B9J,EAAA,GAEN+J,EAFM/J,EAAA,GAiB3B4C,EAAO,eAAAnD,EAAArC,OAAA4M,EAAA,EAAA5M,CAAAiH,EAAAjE,EAAA6J,KAAG,SAAA7F,EAAOnE,GAAP,OAAAoE,EAAAjE,EAAAkE,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cACZsF,GAAsB,GACtBrM,QAAQC,IAAI,wBAAyBsC,GAFzBsE,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAIFyF,GAAUzB,WAAWxI,EAAOzC,EAAO2B,GAJjC,OAAAoF,EAAAE,KAAA,gBAAAF,EAAAC,KAAA,EAAAD,EAAAM,GAAAN,EAAA,SAMR7G,QAAQwG,MAAM,6BAAdK,EAAAM,GAAmDN,EAAAM,IAASN,EAAAM,GAAMV,MAClEhF,EAAS,CACLvB,KAAM,WARF,yBAAA2G,EAAAO,SAAAV,EAAA,iBAAH,gBAAA+F,GAAA,OAAA1K,EAAA2K,MAAAC,KAAAC,YAAA,GAab,OACInK,EAAAC,EAAAC,cAAAF,EAAAC,EAAAmK,SAAA,KACIpK,EAAAC,EAAAC,cAACmK,EAAD,CACI9K,KAAMoK,EACNnK,aAAcnC,EAAMyC,MACpBL,SAAU,kBAAMmK,GAAsB,IACtClK,UAAW+C,IAEfzC,EAAAC,EAAAC,cAACoK,EAAA,EAAD,CACIC,GAAG,QACHC,MAAM,MACNC,QAAM,EACNC,SAtCK,SAACC,EAAKpK,GACnB,OAAQoK,GACJ,IAAK,SACDf,GAAsB,GACtB,MACJ,IAAK,UAEDG,GAAUvB,OAAOnL,EAAO2B,MAgCxBgB,EAAAC,EAAAC,cAACoK,EAAA,EAAOM,MAAR,CAAcxI,KAAK,SAAnB,eACApC,EAAAC,EAAAC,cAACoK,EAAA,EAAOO,OAAR,CAAeC,gBAAc,qBAC7B9K,EAAAC,EAAAC,cAACoK,EAAA,EAAOS,SAAR,CAAiBrO,GAAG,oBAChBsD,EAAAC,EAAAC,cAAC8K,EAAA,EAAD,CAAKxJ,UAAU,YACfxB,EAAAC,EAAAC,cAAC8K,EAAA,EAAD,KACmC,cAA9B3N,EAAMM,KAAKC,eACNoC,EAAAC,EAAAC,cAAC8K,EAAA,EAAIC,KAAL,CAAU7I,KAAK,WAAf,UACApC,EAAAC,EAAAC,cAAC8K,EAAA,EAAIC,KAAL,CAAU7I,KAAK,UAAf,YAKf/E,EAAMM,KAAKC,gBAAmBP,EAAMM,KAAKE,eAMtC,KALAmC,EAAAC,EAAAC,cAACgL,EAAD,CACEpJ,UAAW,kBAAM9C,EAAS,CACtBvB,KAAM,mBAEVsE,SAAU,kBAAM6H,GAAsB,MAG9C5J,EAAAC,EAAAC,cAACiL,EAAD,CACI3I,OAAQnF,EAAMS,aACd2E,QAAS,kBAAMmH,GAAsB,0DC1CtCwB,OAxBf,SAAA9L,GAAyC,IAAvBsC,EAAuBtC,EAAvBsC,QACd,OACI5B,EAAAC,EAAAC,cAACmL,GAAApL,EAAD,CAAMY,MAAO,CACTyK,MAAO,OACPC,OAAQ,QACRC,OAAQ,MACRC,aAAc,MACdC,YAAa,SACbC,WAAY,cACZC,YAAa,QACbC,YAAa,SACbC,MAAO,SAEXlK,QAASA,GAEL5B,EAAAC,EAAAC,cAACmL,GAAApL,EAAKW,KAAN,KACIZ,EAAAC,EAAAC,cAACmL,GAAApL,EAAKU,MAAN,CAAYE,MAAO,CAACkL,cAAe,WAAnC,+ECSDC,OAnBf,SAAA1M,GAAsF,IAA/DC,EAA+DD,EAA/DC,KAAMgI,EAAyDjI,EAAzDiI,MAAO0E,EAAkD3M,EAAlD2M,QAASxM,EAAyCH,EAAzCG,SAAUC,EAA+BJ,EAA/BI,UAAWjC,EAAoB6B,EAApB7B,KAC9D,OACIuC,EAAAC,EAAAC,cAACgM,GAAAjM,EAAD,CAAOV,KAAMA,EAAMa,OAAQX,GACzBO,EAAAC,EAAAC,cAACgM,GAAAjM,EAAMQ,OAAP,CAAcC,aAAW,GACvBV,EAAAC,EAAAC,cAACgM,GAAAjM,EAAMU,MAAP,KAAc4G,IAEhBvH,EAAAC,EAAAC,cAACgM,GAAAjM,EAAMW,KAAP,KAAaqL,GACbjM,EAAAC,EAAAC,cAACgM,GAAAjM,EAAMwB,OAAP,KACEzB,EAAAC,EAAAC,cAACiM,GAAAlM,EAAD,CAAQ0B,QAAQ,YAAYC,QAASnC,GAArC,UAGAO,EAAAC,EAAAC,cAACiM,GAAAlM,EAAD,CAAQ0B,QAAkB,WAATlE,EAAoB,SAAW,UAAWmE,QAASlC,GACxD,WAATjC,EAAoB,SAAW,cCkF/B2O,OA9Ff,SAAA9M,GAA0D,IAAvC3C,EAAuC2C,EAAvC3C,QAAS0P,EAA8B/M,EAA9B+M,OAAQC,EAAsBhN,EAAtBgN,OAAsB3M,EACxBC,oBAAS,GADeC,EAAA5C,OAAA8B,EAAA,EAAA9B,CAAA0C,EAAA,GAC/C4M,EAD+C1M,EAAA,GACtC2M,EADsC3M,EAAA,GAAA+C,EAE5BhD,mBAASjD,EAAQ4K,OAFW1E,EAAA5F,OAAA8B,EAAA,EAAA9B,CAAA2F,EAAA,GAE/C2E,EAF+C1E,EAAA,GAExC4J,EAFwC5J,EAAA,GAAA6J,EAG9B9M,mBAASjD,EAAQ6K,MAHamF,EAAA1P,OAAA8B,EAAA,EAAA9B,CAAAyP,EAAA,GAG/ClF,EAH+CmF,EAAA,GAGzCC,EAHyCD,EAAA,GAAAE,EAIZjN,oBAAS,GAJGkN,EAAA7P,OAAA8B,EAAA,EAAA9B,CAAA4P,EAAA,GAI/CE,EAJ+CD,EAAA,GAIhCE,EAJgCF,EAAA,GAMhDxM,EAAW,SAACC,GACdA,EAAMC,iBACN6L,EAAOpP,OAAAC,EAAA,EAAAD,CAAA,GACAN,EADD,CAEF4K,QACAC,UAEJgF,GAAW,IA0Ef,OACID,EAvEAvM,EAAAC,EAAAC,cAAAF,EAAAC,EAAAmK,SAAA,KACIpK,EAAAC,EAAAC,cAAC+M,GAAD,CACI1N,KAAMwN,EACNxF,MAAM,iBACN0E,QAAQ,4CACRxM,SAAU,kBAAMuN,GAAiB,IACjCtN,UAAW4M,EACX7O,KAAK,WACTuC,EAAAC,EAAAC,cAACgN,GAAAjN,EAAD,CACIkN,YAAU,EACV7M,SAAUA,GACVN,EAAAC,EAAAC,cAACmL,GAAApL,EAAD,CAAMY,MAAO,CACTyK,MAAO,OACPC,OAAQ,QACRC,OAAQ,MACRC,aAAc,QAEdzL,EAAAC,EAAAC,cAACmL,GAAApL,EAAKW,KAAN,KACIZ,EAAAC,EAAAC,cAACmL,GAAApL,EAAKU,MAAN,KACIX,EAAAC,EAAAC,cAACgN,GAAAjN,EAAKiB,QAAN,CACIkM,GAAG,QACHhM,SAAU,SAAC1C,GAAD,OAAO+N,EAAS/N,EAAE2C,OAAOC,QACnC+L,aAAc1Q,EAAQ4K,SAG9BvH,EAAAC,EAAAC,cAACmL,GAAApL,EAAKsB,KAAN,KACIvB,EAAAC,EAAAC,cAACgN,GAAAjN,EAAKiB,QAAN,CACIkM,GAAG,WACHhM,SAAU,SAAC1C,GAAD,OAAOkO,EAAQlO,EAAE2C,OAAOC,QAClC+L,aAAc1Q,EAAQ6K,KACtB3G,MAAO,CAAC0K,OAAQ,QAASE,aAAc,WAG/CzL,EAAAC,EAAAC,cAAA,OAAKW,MAAO,CAAEyM,QAAS,OAAQC,eAAgB,kBAC3CvN,EAAAC,EAAAC,cAACiM,GAAAlM,EAAD,CAAQ0K,IAAI,SAAShJ,QAAQ,iBAAiBC,QAAS,kBAAMoL,GAAiB,KAA9E,UAGAhN,EAAAC,EAAAC,cAACiM,GAAAlM,EAAD,CAAQ0K,IAAI,OAAOlN,KAAK,UAAxB,aAWpBuC,EAAAC,EAAAC,cAACmL,GAAApL,EAAD,CAAMY,MAAO,CACTyK,MAAO,OACPC,OAAQ,QACRC,OAAQ,MACRC,aAAc,QAEdzL,EAAAC,EAAAC,cAACmL,GAAApL,EAAKW,KAAN,KACIZ,EAAAC,EAAAC,cAACmL,GAAApL,EAAKU,MAAN,KACKhE,EAAQ4K,OAEbvH,EAAAC,EAAAC,cAAA,OAAKW,MAAO,CAAC2M,SAAU,OAAQjC,OAAQ,QAASE,aAAc,OAAQgC,WAAY,aAC9EzN,EAAAC,EAAAC,cAACmL,GAAApL,EAAKsB,KAAN,KACS5E,EAAQ6K,OAGrBxH,EAAAC,EAAAC,cAACiM,GAAAlM,EAAD,CAAQ0B,QAAQ,UAAUC,QAAS,WAAO4K,GAAW,KAArD,WChDDkB,OAvCf,WAAgC,IAAAnE,EACFC,qBAAWC,IADTC,EAAAzM,OAAA8B,EAAA,EAAA9B,CAAAsM,EAAA,GACrBlM,EADqBqM,EAAA,GACd1K,EADc0K,EAAA,GAE5B,OACI1J,EAAAC,EAAAC,cAAAF,EAAAC,EAAAmK,SAAA,KACIpK,EAAAC,EAAAC,cAACyN,GAAA,EAAD,KACI3N,EAAAC,EAAAC,cAAC0N,GAAA,EAAD,CAAKpM,UAAU,6BACdnE,EAAMM,KAAKlB,MAAM0K,IAAI,SAAA0G,GAAI,OACtB7N,EAAAC,EAAAC,cAAC4N,GAAA,EAAD,CAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAIxD,IAAKkD,EAAKnR,IAChDsD,EAAAC,EAAAC,cAACkO,GAAD,CACIzR,QAASkR,EACTxB,OAAQ,SAACvP,GAAD,OAAUkC,EAAS,CACvBvB,KAAM,aACNf,GAAImR,EAAKnR,GACTC,QAASG,KAEbwP,OAAQ,kBAAMtN,EAAS,CACnBvB,KAAM,aACNf,GAAImR,EAAKnR,WAKzBsD,EAAAC,EAAAC,cAAC4N,GAAA,EAAD,CAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAIxD,IAAI,cAC1C3K,EAAAC,EAAAC,cAACmO,GAAD,CAASzM,QAAS,kBAAM5C,EAAS,CAC7BvB,KAAM,UACNd,QAAS,CACLD,GAAI,UAAW,IAAI4R,MAAOC,UAC1BhH,MAAO,WACPC,KAAM,cCNnBgH,OAxBf,SAA8BnR,EAAc2B,GACxC,OAAO,SAAC1B,GACJ0B,EAAS1B,GACa,WAAlBA,EAAOgK,QAInB,SAAsBhK,EAAQD,EAAO2B,GACjC,GAA2B,aAAvB3B,EAAMS,aAEV,OAAQR,EAAOG,MACX,IAAK,UACDsM,GAAU1C,kBAAkB/J,EAAOX,QAASqC,GAC5C,MACJ,IAAK,aACD+K,GAAUX,mBAAmB9L,EAAOX,QAASqC,GAC7C,MACJ,IAAK,aACD+K,GAAUV,mBAAmB/L,EAAOZ,GAAIsC,IAfZyP,CAAanR,EAAQD,EAAO2B,KCGvDyK,GAAeiF,wBAAwB,CAAC,KAAM,oDAwD3D,SAAA9J,EAA2BvH,EAAO2B,EAAU2P,EAAOC,GAAnD,IAAApJ,EAAA,OAAAtB,EAAAjE,EAAAkE,KAAA,SAAAU,GAAA,cAAAA,EAAAR,KAAAQ,EAAAP,MAAA,UACE/G,QAAQC,IAAI,gCACZuM,GAAUzG,KAAKjG,EAAO2B,GAChBwG,EAAUqJ,OAAOC,SAAS1M,KAChCwM,EAAQG,KAAK,KACgB,MAAzB1R,EAAMM,KAAKD,WALjB,CAAAmH,EAAAP,KAAA,QAMI/G,QAAQwG,MAAM,kCACd/E,EAAS,CACPvB,KAAM,gBARZoH,EAAAP,KAAA,uBAAAO,EAAAP,KAAA,GAWUyF,GAAUxB,YAAY/C,EAASnI,EAAMM,KAAKD,WAAYL,EAAO2B,GAXvE,yBAAA6F,EAAAF,SAAAC,6BAeeoK,OAjEf,WAAqB,IAAAC,EACYtQ,IADZuQ,EAAAjS,OAAA8B,EAAA,EAAA9B,CAAAgS,EAAA,GACZ5R,EADY6R,EAAA,GACLC,EADKD,EAAA,GAEblQ,EANR,SAAoB3B,GAClB,MAAqC,cAA9BA,EAAMM,KAAKC,gBAAyD,aAAvBP,EAAMS,aAKzCsR,CAAW/R,GAASmR,GAAqBnR,EAAO8R,GAAiBA,EAkBlF,OAjBAlQ,oBAAU,WAC0B,cAA9B5B,EAAMM,KAAKC,gBACbX,OAAA4M,EAAA,EAAA5M,CAAAiH,EAAAjE,EAAA6J,KAAC,SAAA7F,IAAA,OAAAC,EAAAjE,EAAAkE,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAC,KAAA,EAEG0F,GAAUzG,KAAKjG,EAAO2B,GAFzBoF,EAAAE,KAAA,EAGsByF,GAAU1B,gBAAgBhL,EAAO2B,GAHvD,WAAAoF,EAAAK,KAAA,CAAAL,EAAAE,KAAA,eAAAF,EAAAE,KAAA,EAKWyF,GAAUtB,KAAKpL,EAAO2B,GALjC,OAMK+K,GAAUrB,gBAAgBrL,EAAO2B,GANtC,OAAAoF,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAM,GAAAN,EAAA,SASG7G,QAAQwG,MAAM,4BAAdK,EAAAM,IATH,yBAAAN,EAAAO,SAAAV,EAAA,iBAADhH,IAaD,CAACI,EAAMM,KAAKD,WAAYL,EAAMM,KAAKC,iBAGpCoC,EAAAC,EAAAC,cAAA,OAAKsB,UAAU,OACbxB,EAAAC,EAAAC,cAACmP,EAAA,EAAD,KACErP,EAAAC,EAAAC,cAACoP,EAAA,EAAD,CACEC,KAAK,gBACLC,OAAQ,SAAAC,GAAsB,IAApBd,EAAoBc,EAApBd,MAAOC,EAAaa,EAAbb,QAEf,kDADAc,CAAYrS,EAAO2B,EAAU2P,EAAOC,GAC7B,QAGX5O,EAAAC,EAAAC,cAACoP,EAAA,EAAD,CACEC,KAAK,aACLC,OAAQ,SAAAG,GAAwB,IAArBhB,EAAqBgB,EAArBhB,MAET,OAF8BgB,EAAdf,QAChBrR,QAAQC,IAAI,UAAWmR,EAAMiB,OAAOC,SAElC7P,EAAAC,EAAAC,cAACuJ,GAAaqG,SAAd,CAAuBxO,MAAO,CAACjE,EAAO2B,IACpCgB,EAAAC,EAAAC,cAAA,OAAKsB,UAAU,oBACbxB,EAAAC,EAAAC,cAAC6P,GAAD,OAEF/P,EAAAC,EAAAC,cAAA,OAAKsB,UAAU,gBACbxB,EAAAC,EAAAC,cAAC8P,GAAD,cCjDEC,QACW,cAA7BpB,OAAOC,SAASoB,UAEe,UAA7BrB,OAAOC,SAASoB,UAEhBrB,OAAOC,SAASoB,SAASvB,MACvB,2DCXNwB,IAASX,OAAOxP,EAAAC,EAAAC,cAACkQ,GAAD,MAASC,SAASC,eAAe,SD0H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,KAAK,SAAAC,GACjCA,EAAaC","file":"static/js/main.2805da9c.chunk.js","sourcesContent":["/**\r\n * @flow\r\n */\r\nimport { useReducer } from 'react';\r\n\r\nexport type Note = {|\r\n    id: string,\r\n    title: ?string,\r\n    body: ?string,\r\n|};\r\n\r\nexport type ConnectState = 'loginStarted' | 'loggedIn' | 'loginFailed';\r\n\r\nexport type DataState = {|\r\n    notes: Array<Note>,\r\n    loginEmail?: string,\r\n    loginFlowStage?: 'started' | 'completed',\r\n    upSellDisabled?: boolean,\r\n|};\r\n\r\nexport type State = {|\r\n    data: DataState,\r\n    connectState?: ConnectState,\r\n|};\r\n\r\nfunction addNote(notes: Array<Note>, content: Note): Array<Note> {\r\n    const index = notes.findIndex(note => note.id === content.id);\r\n    if (index !== -1) return notes; // cannot add with same id\r\n\r\n    console.log('adding note with id: ', content.id);\r\n    return notes\r\n        .concat({\r\n            ...content,\r\n        });\r\n}\r\n\r\nfunction replaceNote(notes: Array<Note>, id: string, content: Note): Array<Note> {\r\n    const index = notes.findIndex(note => note.id === id);\r\n    if (index === -1) return notes;\r\n    return notes\r\n        .slice(0, index)\r\n        .concat({\r\n            ...content,\r\n            id: content.id || id,\r\n        })\r\n        .concat(\r\n            notes.slice(index + 1)\r\n        );\r\n}\r\n\r\nfunction removeNote(notes: Array<Note>, id: string): Array<Note> {\r\n    const index = notes.findIndex(note => note.id === id);\r\n    if (index === -1) return notes;\r\n    return notes\r\n        .slice(0, index)\r\n        .concat(\r\n            notes.slice(index + 1)\r\n        );\r\n}\r\n\r\n/**\r\n * Reducer for actions that can modify both persistent (state.data) and non-persistent (state) data\r\n */\r\nexport function reducer(state: State, action: any): State {\r\n    console.log('reducer action:', action.type, action);\r\n    switch (action.type) {\r\n        case 'startLogin':\r\n            if (action.loginEmail == null) return state;\r\n            return {\r\n                ...state,\r\n                data: {\r\n                    ...state.data,\r\n                    loginEmail: action.loginEmail,\r\n                    loginFlowStage: 'started',\r\n                    upSellDisabled: true,\r\n                },\r\n                connectState: 'loginStarted',\r\n            };\r\n        case 'completeLogin':\r\n            return {\r\n                ...state,\r\n                data: {\r\n                    ...state.data,\r\n                    loginFlowStage: 'completed',\r\n                },\r\n                connectState: 'loggedIn',\r\n            };\r\n        case 'loginFailed':\r\n            return {\r\n                ...state,\r\n                data: {\r\n                    ...state.data,\r\n                },\r\n                connectState: 'loginFailed',\r\n            };\r\n        case 'logout':\r\n            return {\r\n                ...state,\r\n                data: {\r\n                    ...state.data,\r\n                    loginEmail: undefined,\r\n                    loginFlowStage: undefined,\r\n                },\r\n                connectState: undefined,\r\n            };\r\n        case 'setConnectState':\r\n            return {\r\n                ...state,\r\n                connectState: action.connectState,\r\n            };            \r\n        default: return {\r\n            ...state,\r\n            data: dataReducer(state.data, action),\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * Reducer for actions that only modify persistent data\r\n */\r\nfunction dataReducer(state: DataState, action: any): DataState {\r\n    switch (action.type) {\r\n        case 'addNote':\r\n            return {\r\n                ...state,\r\n                notes: addNote(state.notes, action.content),\r\n            };\r\n        case 'modifyNote':\r\n            if (action.id == null) return state;\r\n            return {\r\n                ...state,\r\n                notes: replaceNote(state.notes, action.id, action.content),\r\n            };\r\n        case 'removeNote':\r\n            if (action.id == null) return state;\r\n            return {\r\n                ...state,\r\n                notes: removeNote(state.notes, action.id),\r\n            };\r\n        case 'disableUpSell':\r\n            return {\r\n                ...state,\r\n                upSellDisabled: true,\r\n            };\r\n\r\n        default: throw new Error('unknown action: ' + action.type);\r\n    }\r\n}\r\n\r\nexport default function notesReducer(initState: () => State) {\r\n    return useReducer<State, any, null>(reducer, null, initState);\r\n}","/**\r\n * Decorator for notesReducer that loads/saves state from local storage\r\n * \r\n * @flow\r\n */\r\nimport type { DataState } from './notesReducer';\r\n\r\nimport { useEffect } from 'react';\r\nimport notesReducer from './notesReducer';\r\n\r\nconst LOCAL_STORAGE_KEY = 'appState';\r\n\r\nfunction initState() {\r\n    console.log('loading data from local storage');\r\n    const storedItem = localStorage.getItem(LOCAL_STORAGE_KEY) || '';\r\n    let loadedDataState;\r\n    try {\r\n        loadedDataState = JSON.parse(storedItem);\r\n    } catch (e) {\r\n        loadedDataState = null;\r\n    }\r\n    return {\r\n        data: loadedDataState || {\r\n            notes: [],\r\n        },\r\n    };\r\n}\r\n\r\nfunction saveState(dataState: DataState) {\r\n    console.log('saving data to local storate');\r\n    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(dataState));\r\n}\r\n\r\nfunction localStorageReducer() {\r\n    const [state, dispatch] = notesReducer(initState);\r\n\r\n    useEffect(() => {\r\n        saveState(state.data);\r\n    }, [state.data]);\r\n\r\n    return [state, dispatch];\r\n}\r\n\r\nexport default localStorageReducer;","/**\r\n * @flow\r\n */\r\nimport type {Node} from 'react';\r\n\r\nimport { Button, Form, Modal } from 'react-bootstrap';\r\nimport React, { useState } from 'react';\r\n\r\ntype Props = {|\r\n  show: boolean,\r\n  initialEmail: ?string,\r\n  onCancel: () => void,\r\n  onConfirm: (string) => Promise<any>,\r\n|};\r\n\r\nfunction LoginModal({show, initialEmail, onCancel, onConfirm}: Props): Node {\r\n    const [email, setEmail] = useState(initialEmail);\r\n\r\n    const onSubmit = (event) => {\r\n      event.preventDefault();\r\n      if (email) onConfirm(email);\r\n    }\r\n\r\n    return (\r\n      <Modal show={show} onHide={onCancel}>\r\n        <Form onSubmit={onSubmit}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Sign up or Login</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n            <div style={{paddingBottom: 20}}>Want to share your notes between the devices you use? Enter your email below to sign up or login.</div>\r\n              <Form.Group controlId=\"formBasicEmail\">\r\n                <Form.Label>Email address</Form.Label>\r\n                <Form.Control\r\n                  type=\"email\"\r\n                  placeholder=\"Enter email\"\r\n                  onChange={(e) => setEmail(e.target.value)}\r\n                />\r\n                <Form.Text className=\"text-muted\">\r\n                  We'll never share your email with anyone else.\r\n                </Form.Text>\r\n              </Form.Group>\r\n          </Modal.Body>\r\n          <Modal.Footer>\r\n            <Button variant=\"secondary\" onClick={onCancel}>\r\n              Cancel\r\n            </Button>\r\n            <Button variant=\"primary\" type=\"submit\" >\r\n              Login\r\n            </Button>\r\n          </Modal.Footer>\r\n        </Form>\r\n      </Modal>\r\n    );\r\n}\r\n\r\nexport default LoginModal;","\r\n/**\r\n * @flow\r\n */\r\nimport type {Node} from 'react';\r\n\r\nimport Alert from 'react-bootstrap/Alert';\r\nimport React from 'react';\r\n\r\ntype Props = {|\r\n  onDismiss: () => void,\r\n  onAction: () => void,\r\n|};\r\n\r\nfunction LoginUpsellBanner({onDismiss, onAction}: Props): Node {\r\n    const onClick = (event) => {\r\n        event.preventDefault();\r\n        onAction();\r\n    }\r\n\r\n    return (\r\n        <Alert\r\n            dismissible\r\n            variant=\"primary\"\r\n            onClose={onDismiss}>\r\n            <Alert.Heading>Have multiple devices?</Alert.Heading>\r\n            <p>\r\n                You can get your notes on every device by&nbsp;\r\n                <a href=\"#login\" onClick={onClick}>logging in</a>.\r\n            </p>\r\n        </Alert>\r\n    );\r\n}\r\n\r\nexport default LoginUpsellBanner;","\r\n/**\r\n * @flow\r\n */\r\nimport type { Node } from 'react';\r\nimport type { ConnectState } from './notesReducer';\r\n\r\nimport Alert from 'react-bootstrap/Alert';\r\nimport React, { useState } from 'react';\r\n\r\ntype Props = {|\r\n    status: ConnectState,\r\n    onLogin: () => void,\r\n|};\r\n\r\nfunction LoginStatusBanner({status, onLogin}: Props): Node {\r\n    const [showingWarning, setShowingWarning] = useState(true);\r\n    const [showingError, setShowingError] = useState(true);\r\n    const onClick = (event) => {\r\n        event.preventDefault();\r\n        onLogin();\r\n    }\r\n\r\n    switch (status) {\r\n        case 'loginStarted':\r\n            return (\r\n                <Alert\r\n                    dismissible\r\n                    variant=\"primary\"\r\n                    show={showingWarning}\r\n                    onClose={() => setShowingWarning(false)}\r\n                >\r\n                    <Alert.Heading>Waiting to Login</Alert.Heading>\r\n                    <p>\r\n                        Open the login link in an email we just sent you.\r\n                    </p>\r\n                </Alert>\r\n            );\r\n        case 'loggedIn':\r\n            return (\r\n                <Alert\r\n                    dismissible\r\n                    variant=\"success\"\r\n                    show={showingWarning}\r\n                    onClose={() => setShowingWarning(false)}\r\n                >\r\n                    <Alert.Heading>Logged in</Alert.Heading>\r\n                </Alert>\r\n            );\r\n        case 'loginFailed':\r\n            return (\r\n                <Alert\r\n                    dismissible\r\n                    variant=\"danger\"\r\n                    show={showingError}\r\n                    onClose={() => setShowingError(false)}\r\n                >\r\n                    <Alert.Heading>Login failed</Alert.Heading>\r\n                    <p>\r\n                        Please&nbsp;\r\n                        <a href=\"#login\" onClick={onClick}>login</a>&nbsp;again.\r\n                    </p>\r\n                </Alert>\r\n            );\r\n        default:\r\n            return null;\r\n    }\r\n}\r\n\r\nexport default LoginStatusBanner;","/**\r\n * @flow\r\n */\r\nimport type {Note} from './notesReducer';\r\nimport type {State, ConnectState} from './notesReducer';\r\n\r\nimport config from './firebaseConfig.json';\r\nconst firebase = require('firebase/app');\r\nrequire('firebase/auth');\r\nrequire('firebase/firestore');\r\n\r\nlet db;\r\nlet user;\r\nconst baseUrl = process.env.NODE_ENV === 'production' ? 'https://leanlauri.github.io/localnotes' : 'http://localhost:3000';\r\nconst actionCodeSettings = {\r\n    url: `${baseUrl}/finishLogin/`,\r\n    handleCodeInApp: true,\r\n};\r\n\r\nfunction setConnectState(connectState: ConnectState, dispatch: Function) {\r\n    dispatch({\r\n        type: 'setConnectState',\r\n        connectState,\r\n    });\r\n}\r\n\r\nfunction init(state: State, dispatch: Function) {\r\n    try {\r\n        if (!firebase.apps.length) {\r\n            console.log('Initialising Firebase');\r\n            firebase.initializeApp(config);\r\n            initDb();\r\n        }\r\n    } catch (err) {\r\n        console.error('Firestore: Error initialising:', err && err.code);\r\n        setConnectState('loginFailed', dispatch);\r\n    }\r\n}\r\n\r\nfunction initDb() {\r\n    db = firebase.firestore();\r\n    db.enablePersistence()\r\n        .catch(function(err) {\r\n            console.error('Firestore: Failed to enable offline persistence:', err && err.code);\r\n        });\r\n}\r\n\r\nasync function waitForUserAuth(state: State, dispatch: Function): Promise<?firebase.User> {\r\n    if (user) return user;\r\n    try {\r\n        return await addUserStateListener(state, dispatch);\r\n    } catch (err) {\r\n        console.error('Firestore: Error initialising:', err && err.code);\r\n        setConnectState('loginFailed', dispatch);\r\n        return null;\r\n    }\r\n}\r\n\r\nasync function addUserStateListener(state: State, dispatch: Function): Promise<?firebase.User> {\r\n    return new Promise((resolve, reject) => {\r\n        firebase.auth().onAuthStateChanged((userObject) => {\r\n            console.log('authStateChanged, user:', userObject);\r\n            if (userObject) {\r\n                user = userObject;\r\n                dispatch({type: 'completeLogin'});\r\n                resolve(user);\r\n            } else {\r\n                user = null;\r\n                setConnectState('loginFailed', dispatch);\r\n                resolve(null);\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nasync function startLogin(email: string, state: State, dispatch: Function): Promise<void> {\r\n    try {\r\n        console.log('starting login');\r\n        init(state, dispatch);\r\n        await firebase.auth().sendSignInLinkToEmail(email, actionCodeSettings);\r\n        dispatch({\r\n            type: 'startLogin',\r\n            loginEmail: email,\r\n        });\r\n    } catch (err) {\r\n        console.error('Firestore: Login failed:', err && err.code);\r\n        setConnectState('loginFailed', dispatch);\r\n    }\r\n}\r\n\r\nasync function finishLogin(address: string, email: string, state: State, dispatch: Function): Promise<void> {\r\n    try {\r\n        if (!firebase.auth().isSignInWithEmailLink(address)) {\r\n            console.error('Address is not a valid login address:', address);\r\n            dispatch({type: 'loginFailed'});\r\n            return;\r\n        }\r\n        await firebase.auth().signInWithEmailLink(email, address);\r\n        dispatch({type: 'completeLogin'});\r\n    } catch (error) {\r\n        console.error('Error completing login:', error, error && error.code);\r\n        dispatch({type: 'loginFailed'});\r\n      }  \r\n}\r\n\r\nasync function logout(state: State, dispatch: Function): Promise<any> {\r\n    await firebase.auth().signOut();\r\n    dispatch({\r\n        type: 'logout'\r\n    });\r\n}\r\n\r\nasync function sync(state: State, dispatch: Function): Promise<any> {\r\n    if (!db || !user) {\r\n        console.error('DB or user not initialised');\r\n        throw new Error('DB or user not initialised');\r\n    }\r\n    \r\n    await retrieveNotes(state.data.notes, dispatch);\r\n    return sendNotes(state.data.notes, dispatch);            \r\n}\r\n\r\nfunction listenToChanges(state: State, dispatch: Function) {\r\n    if (!db || !user) {\r\n        console.error('DB or user not initialised. Cancelling listen to changes.');\r\n        return;\r\n    }\r\n    \r\n    db.collection('notes').where(\"owner\", \"==\", user.uid)\r\n        .onSnapshot({includeMetadataChanges: true}, (snapshot) => {\r\n            // console.log('snapshot', snapshot);\r\n            if (!snapshot.metadata.fromCache && !snapshot.metadata.hasPendingWrites) {\r\n                snapshot.docChanges().forEach(function(change) {\r\n                    // console.log('change.type', change.type);\r\n                    if (change.type === 'added') {\r\n                        // console.log('New remote note received: ', change.doc.id, change.doc.data());\r\n                        storeNoteLocally(change.doc.id, change.doc.data(), dispatch);\r\n                    } else if (change.type === 'modified') {\r\n                        // console.log('Updated note received: ', change.doc.data());\r\n                        updateNoteLocally(change.doc.id, change.doc.data(), dispatch);\r\n                    } else if (change.type === 'removed') {\r\n                        // console.log('Delete notification received: ', change.doc.id);\r\n                        removeNoteLocally(change.doc.id, dispatch);\r\n                    } \r\n                });\r\n            }\r\n        });\r\n\r\n}\r\n\r\nasync function retrieveNotes(localNotes: Array<Note>, dispatch: Function): Promise<any> {\r\n    if (!user) throw new Error('Not logged in');\r\n    const querySnapshot = await db.collection('notes').where(\"owner\", \"==\", user.uid).get();\r\n    querySnapshot.forEach((doc) => {\r\n        const remoteData = doc.data();\r\n        console.log(`${doc.id} =>`, remoteData);\r\n        const localNote = localNotes.find((note) => note.id === doc.id);\r\n        if (localNote) {\r\n            // TODO: rather than overwrite local data, add more complex logic to consolidate changes\r\n            updateNoteLocally(doc.id, remoteData, dispatch);\r\n        } else {\r\n            storeNoteLocally(doc.id, remoteData, dispatch);\r\n        }\r\n    });\r\n}\r\n\r\nasync function sendNotes(notes: Array<Note>, dispatch: Function): Promise<any> {\r\n    console.log('sending local notes to server');\r\n    await Promise.all(\r\n        notes.map((note) => {\r\n            if (note.id.startsWith('local:')) {\r\n                // console.log('sending note:', note.id);\r\n                return storeNoteRemotely(note, dispatch);\r\n            } else return new Promise((resolve, reject) => resolve());\r\n        })\r\n    );\r\n}\r\n\r\nfunction updateNoteLocally(id, data, dispatch) {\r\n    dispatch({\r\n        type: 'modifyNote',\r\n        source: 'remote',\r\n        id: id,\r\n        content: {\r\n            title: data.title,\r\n            body: data.body,\r\n        }\r\n    });\r\n}\r\n\r\nfunction storeNoteLocally(id, data, dispatch) {\r\n    dispatch({\r\n        type: 'addNote',\r\n        source: 'remote',\r\n        content: {\r\n            id: id,\r\n            title: data.title,\r\n            body: data.body,\r\n        }\r\n    });\r\n}\r\n\r\nfunction removeNoteLocally(id, dispatch) {\r\n    dispatch({\r\n        type: 'removeNote',\r\n        source: 'remote',\r\n        id: id,\r\n    });\r\n}\r\n\r\nasync function storeNoteRemotely(note: Note, dispatch: Function): Promise<void> {\r\n    console.log('storing note to server');\r\n    if (!user) throw new Error('Not logged in');\r\n\r\n    try {\r\n        const docRef = await db.collection('notes').add({\r\n            title: note.title,\r\n            body: note.body,\r\n            owner: user.uid,\r\n        });\r\n        console.log('Document written with ID: ', docRef.id);\r\n        // modify local id to match cloud id\r\n        dispatch({\r\n            type: 'modifyNote',\r\n            source: 'remote',\r\n            id: note.id,\r\n            content: {\r\n                id: docRef.id,\r\n                title: note.title,\r\n                body: note.body, \r\n            }\r\n        })\r\n    } catch (error) {\r\n        console.error('Error adding document: ', error);\r\n    }\r\n}\r\n\r\nasync function updateNoteRemotely(note: Note, dispatch: Function): Promise<void> {\r\n    console.log('updating note on server');\r\n    if (!user) throw new Error('Not logged in');\r\n\r\n    try {\r\n        await db.collection('notes').doc(note.id).set({\r\n            title: note.title,\r\n            body: note.body,\r\n            owner: user.uid,\r\n        })\r\n        console.log(`Document ${note.id} updated`);\r\n    } catch(error) {\r\n        console.error(`Error updating document ${note.id}: `, error);\r\n    }\r\n}\r\n\r\nasync function removeNoteRemotely(id: string, dispatch: Function): Promise<void> {\r\n    console.log('removing note from server');\r\n    if (!user) throw new Error('Not logged in');\r\n\r\n    try {\r\n        await db.collection('notes').doc(id).delete();\r\n        console.log(`Remote document ${id} removed`);\r\n    } catch(error) {\r\n        console.error(`Error removing document ${id}: `, error);\r\n    }\r\n}\r\n\r\nexport default {\r\n    init,\r\n    waitForUserAuth,\r\n    startLogin,\r\n    finishLogin,\r\n    logout,\r\n    sync,\r\n    listenToChanges,\r\n    storeNoteRemotely,\r\n    updateNoteRemotely,\r\n    removeNoteRemotely,\r\n};\r\n","/**\r\n * @flow\r\n */\r\nimport type { Node } from 'react';\r\n\r\nimport React, { useContext, useState } from 'react';\r\nimport { Navbar, Nav } from 'react-bootstrap';\r\nimport LoginModal from './LoginModal';\r\nimport LoginUpSellBanner from './LoginUpSellBanner';\r\nimport { StateContext } from './App';\r\nimport LoginStatusBanner from './LoginStatusBanner';\r\nimport connector from './firebaseConnector';\r\n\r\nfunction LoginBarWithBanners(): Node {\r\n    const [state, dispatch] = useContext(StateContext);\r\n    const [loginDialogVisible, setLoginDialogVisible] = useState(false);\r\n\r\n    const onSelect = (key, event) => {\r\n        switch (key) {\r\n            case '#login':\r\n                setLoginDialogVisible(true);\r\n                break;\r\n            case '#logout':\r\n                // TODO: handle login errors\r\n                connector.logout(state, dispatch);\r\n                break;\r\n            default: break;\r\n        }\r\n    };\r\n\r\n    const onLogin = async (email) => {\r\n        setLoginDialogVisible(false);\r\n        console.log('Login requested with:', email);\r\n        try {\r\n            await connector.startLogin(email, state, dispatch);\r\n        } catch (error) {\r\n            console.error('Error sending login email:', error, error && error.code);\r\n            dispatch({\r\n                type: 'logout',\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <LoginModal\r\n                show={loginDialogVisible}\r\n                initialEmail={state.email}\r\n                onCancel={() => setLoginDialogVisible(false)}\r\n                onConfirm={onLogin}\r\n            />\r\n            <Navbar\r\n                bg=\"light\"\r\n                fixed=\"top\"\r\n                expand\r\n                onSelect={onSelect}>\r\n                <Navbar.Brand href=\"#home\">Local Notes</Navbar.Brand>\r\n                <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\r\n                <Navbar.Collapse id=\"basic-navbar-nav\">\r\n                    <Nav className=\"mr-auto\"></Nav>\r\n                    <Nav>\r\n                        {state.data.loginFlowStage === 'completed'\r\n                            ? <Nav.Link href=\"#logout\">Logout</Nav.Link>\r\n                            : <Nav.Link href=\"#login\">Login</Nav.Link>\r\n                        }\r\n                    </Nav>\r\n                </Navbar.Collapse>\r\n            </Navbar>\r\n            {(!state.data.loginFlowStage && !state.data.upSellDisabled)\r\n                ? <LoginUpSellBanner\r\n                    onDismiss={() => dispatch({\r\n                        type: 'disableUpSell'\r\n                    })}\r\n                    onAction={() => setLoginDialogVisible(true)}/>\r\n                : null\r\n            }\r\n            <LoginStatusBanner\r\n                status={state.connectState}\r\n                onLogin={() => setLoginDialogVisible(true)}/>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default LoginBarWithBanners;\r\n","/**\r\n * @flow\r\n */\r\nimport type {Node} from 'react';\r\n\r\nimport Card from 'react-bootstrap/Card';\r\nimport React from 'react';\r\n\r\ntype Props = {|\r\n    onClick: () => void,\r\n|};\r\n\r\nfunction AddCard({onClick}: Props): Node {\r\n    return (\r\n        <Card style={{ \r\n            width: '100%',\r\n            height: '20rem',\r\n            margin: '4px',\r\n            marginBottom: '8px',\r\n            borderStyle: 'dashed',\r\n            background: 'transparent',\r\n            borderColor: 'white',\r\n            borderWidth: 'medium',\r\n            color: 'white',\r\n        }}\r\n        onClick={onClick}\r\n        >\r\n            <Card.Body>\r\n                <Card.Title style={{verticalAlign: 'center'}}>\r\n                    Add new note\r\n                </Card.Title>\r\n            </Card.Body>\r\n        </Card>\r\n    );\r\n}\r\n\r\nexport default AddCard;","/**\r\n * @flow\r\n */\r\nimport type {Node} from 'react';\r\n\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport Button from 'react-bootstrap/Button';\r\nimport React from 'react';\r\n\r\ntype Props = {|\r\n    show: boolean,\r\n    title: string,\r\n    message: string,\r\n    onCancel: () => void,\r\n    onConfirm: () => void,\r\n    type: 'confirm' | 'remove',\r\n|};\r\n\r\nfunction ConfirmModal({show, title, message, onCancel, onConfirm, type}: Props): Node {\r\n    return (\r\n        <Modal show={show} onHide={onCancel}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>{title}</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>{message}</Modal.Body>\r\n          <Modal.Footer>\r\n            <Button variant=\"secondary\" onClick={onCancel}>\r\n              Cancel\r\n            </Button>\r\n            <Button variant={type === 'remove' ? 'danger' : 'primary'} onClick={onConfirm}>\r\n              {type === 'remove' ? 'Remove' : 'Confirm'}\r\n            </Button>\r\n          </Modal.Footer>\r\n        </Modal>\r\n    );\r\n}\r\n\r\nexport default ConfirmModal;","/**\r\n * @flow\r\n */\r\nimport type {Node} from 'react';\r\nimport type {Note} from './notesReducer';\r\n\r\nimport Button from 'react-bootstrap/Button';\r\nimport Card from 'react-bootstrap/Card';\r\nimport React, { useState } from 'react';\r\nimport Form from 'react-bootstrap/Form';\r\nimport ConfirmModal from './ConfirmModal';\r\n\r\ntype Props = {|\r\n    content: Note,\r\n    update: Note => void,\r\n    remove: () => void,\r\n|};\r\n\r\nfunction NoteCard({content, update, remove}: Props): Node {\r\n    const [editing, setEditing] = useState(false);\r\n    const [title, setTitle] = useState(content.title);\r\n    const [body, setBody] = useState(content.body);\r\n    const [dialogVisible, setDialogVisible] = useState(false);\r\n\r\n    const onSubmit = (event) => {\r\n        event.preventDefault();\r\n        update({\r\n            ...content,\r\n            title,\r\n            body,\r\n        });\r\n        setEditing(false);\r\n    }\r\n    \r\n    const createForm = () => (\r\n        <>\r\n            <ConfirmModal\r\n                show={dialogVisible}\r\n                title=\"Confirm remove\"\r\n                message=\"Are you sure you want to remove the note?\"\r\n                onCancel={() => setDialogVisible(false)}\r\n                onConfirm={remove}\r\n                type=\"remove\"/>\r\n            <Form\r\n                noValidate\r\n                onSubmit={onSubmit}>\r\n                <Card style={{ \r\n                    width: '100%',\r\n                    height: '20rem',\r\n                    margin: '4px',\r\n                    marginBottom: '8px',\r\n                }}>\r\n                    <Card.Body>\r\n                        <Card.Title>\r\n                            <Form.Control \r\n                                as=\"input\"\r\n                                onChange={(e) => setTitle(e.target.value)}\r\n                                defaultValue={content.title}\r\n                            />\r\n                        </Card.Title>\r\n                        <Card.Text>\r\n                            <Form.Control\r\n                                as=\"textarea\"\r\n                                onChange={(e) => setBody(e.target.value)}\r\n                                defaultValue={content.body}\r\n                                style={{height: '11rem', marginBottom: '1rem'}}\r\n                            />\r\n                        </Card.Text>\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                            <Button key=\"remove\" variant=\"outline-danger\" onClick={() => setDialogVisible(true)}>\r\n                                Remove\r\n                            </Button>\r\n                            <Button key=\"save\" type=\"submit\">\r\n                                Save\r\n                            </Button>\r\n                        </div>\r\n                    </Card.Body>\r\n                </Card>\r\n            </Form>\r\n        </>\r\n    );\r\n\r\n    const createView = () => (\r\n        <Card style={{ \r\n            width: '100%',\r\n            height: '20rem',\r\n            margin: '4px',\r\n            marginBottom: '8px',\r\n        }}>\r\n            <Card.Body>\r\n                <Card.Title>\r\n                    {content.title}\r\n                </Card.Title>\r\n                <div style={{overflow: 'auto', height: '12rem', marginBottom: '1rem', whiteSpace: 'pre-line'}}>\r\n                    <Card.Text>\r\n                            {content.body}\r\n                    </Card.Text>\r\n                </div>\r\n                <Button variant=\"primary\" onClick={() => {setEditing(true)}}>\r\n                    Edit\r\n                </Button>\r\n            </Card.Body>\r\n        </Card>\r\n    );\r\n    \r\n    return (\r\n        editing\r\n            ? createForm()\r\n            : createView()\r\n    );\r\n}\r\n\r\nexport default NoteCard;","/**\r\n * @flow\r\n */\r\nimport type {Node} from 'react';\r\n\r\nimport { Container, Row, Col } from 'react-bootstrap';\r\nimport React, { useContext } from 'react';\r\nimport AddCard from './AddCard';\r\nimport NoteCard from './NoteCard';\r\nimport { StateContext } from './App';\r\n\r\nfunction NotesContainer(): Node {\r\n    const [state, dispatch] = useContext(StateContext);\r\n    return (\r\n        <>\r\n            <Container >\r\n                <Row className=\"justify-content-md-center\" >\r\n                {state.data.notes.map(item => \r\n                    <Col xs=\"12\" sm=\"12\" md=\"6\" lg=\"4\" xl=\"4\" key={item.id}>\r\n                        <NoteCard\r\n                            content={item}\r\n                            update={(note) => dispatch({\r\n                                type: 'modifyNote',\r\n                                id: item.id,\r\n                                content: note,\r\n                            })}\r\n                            remove={() => dispatch({\r\n                                type: 'removeNote',\r\n                                id: item.id,\r\n                            })}\r\n                            />\r\n                    </Col>\r\n                )}\r\n                <Col xs=\"12\" sm=\"12\" md=\"6\" lg=\"4\" xl=\"4\" key=\"add-button\">\r\n                    <AddCard onClick={() => dispatch({\r\n                        type: 'addNote',\r\n                        content: {\r\n                            id: 'local:' + new Date().getTime(),\r\n                            title: 'New Note',\r\n                            body: '',\r\n                        }\r\n                    })}/>\r\n                </Col>\r\n                </Row>\r\n            </Container>\r\n        </>\r\n\r\n    );\r\n}\r\n\r\nexport default NotesContainer;","/**\r\n * Decorator for notesReducer that saves state to remote storage\r\n * \r\n * @flow\r\n */\r\nimport type { State } from './notesReducer';\r\n\r\nimport connector from './firebaseConnector';\r\n  \r\nfunction createRemoteDispatch(state: State, dispatch: Function): Function {\r\n    return (action) => {\r\n        dispatch(action);\r\n        if (action.source !== 'remote') handleAction(action, state, dispatch);\r\n    }\r\n}\r\n\r\nfunction handleAction(action, state, dispatch) {\r\n    if (state.connectState !== 'loggedIn') return;\r\n\r\n    switch (action.type) {\r\n        case 'addNote':\r\n            connector.storeNoteRemotely(action.content, dispatch);\r\n            break;\r\n        case 'modifyNote':\r\n            connector.updateNoteRemotely(action.content, dispatch);\r\n            break;\r\n        case 'removeNote':\r\n            connector.removeNoteRemotely(action.id, dispatch);\r\n            break;\r\n        default: break;\r\n    }\r\n}\r\n\r\nexport default createRemoteDispatch;","/**\r\n * @flow\r\n */\r\nimport type { Node } from 'react';\r\nimport type { State } from './notesReducer';\r\n\r\nimport React, { createContext, useEffect } from 'react';\r\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\r\nimport './App.css';\r\nimport localStorageReducer from './localStorageReducer';\r\nimport LoginBarWithBanners from './LoginBarWithBanners';\r\nimport NotesContainer from './NotesContainer';\r\nimport connector from './firebaseConnector';\r\nimport createRemoteDispatch from './remoteDispatch';\r\n\r\nexport const StateContext = createContext<any, any>([null, null]);\r\n\r\nfunction isLoggedIn(state: State): boolean {\r\n  return state.data.loginFlowStage === 'completed' && state.connectState === 'loggedIn';\r\n}\r\n\r\nfunction App(): Node {\r\n  const [state, localDispatch] = localStorageReducer();\r\n  const dispatch = isLoggedIn(state) ? createRemoteDispatch(state, localDispatch) : localDispatch;\r\n  useEffect(() => {\r\n    if (state.data.loginFlowStage === 'completed') {\r\n      (async () => {\r\n        try {\r\n          connector.init(state, dispatch);\r\n          const user = await connector.waitForUserAuth(state, dispatch);\r\n          if (user) {\r\n            await connector.sync(state, dispatch);\r\n            connector.listenToChanges(state, dispatch);\r\n          }\r\n        } catch (error) {\r\n          console.error('Error synchronising data:', error);\r\n        }\r\n      })();\r\n   }\r\n  }, [state.data.loginEmail, state.data.loginFlowStage]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Router>\r\n        <Route\r\n          path=\"/finishLogin/\"\r\n          render={({match, history}) => {\r\n            handleLogin(state, dispatch, match, history);\r\n            return null;\r\n          }}/>\r\n          \r\n        <Route  \r\n          path=\"/:section?\"\r\n          render={({ match, history }) => {\r\n            console.log('Section', match.params.section); // not currently used\r\n            return (\r\n              <StateContext.Provider value={[state, dispatch]}>\r\n                <div className=\"topbar-container\">\r\n                  <LoginBarWithBanners />\r\n                </div>\r\n                <div className=\"App-contents\">\r\n                  <NotesContainer />\r\n                </div>  \r\n              </StateContext.Provider>\r\n            );\r\n          }}/>\r\n      </Router>\r\n    </div>\r\n  );\r\n}\r\n\r\nasync function handleLogin(state, dispatch, match, history) {\r\n  console.log('Handling finishLogin request');\r\n  connector.init(state, dispatch);\r\n  const address = window.location.href;\r\n  history.push('/');\r\n  if (state.data.loginEmail == null) {\r\n    console.error('No login email in stored state');\r\n    dispatch({\r\n      type: 'loginFailed',\r\n    });\r\n  } else {\r\n    await connector.finishLogin(address, state.data.loginEmail, state, dispatch);\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}